<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Best Bank Loan Credit Engine</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body { background: #f8f9fa; }
    .container { max-width: 650px; margin-top: 40px; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px #0001; padding: 30px; }
    .form-label { font-weight: 500; }
    .form-check-label { font-weight: 400; }
    .result-box { background: #f4f4f4; border-radius: 8px; padding: 16px; margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="text-center mb-3" style="font-size:1.5em; font-weight:700; color:#388e3c; background:linear-gradient(90deg,#e8f5e9 0%,#fffbe7 100%); border-radius:12px; padding:14px 0; box-shadow:0 2px 8px #0002; letter-spacing:1px;">
      95% Accuracy! Tested with 25+ Customers
    </div>
    <div class="text-center mb-2" style="font-size:1.1em; font-weight:500; color:#1976d2; background:linear-gradient(90deg,#e3f2fd 0%,#fffbe7 100%); border-radius:8px; padding:8px 0; box-shadow:0 1px 4px #0001; letter-spacing:0.5px;">
      ‚è± Takes 2 mins. üè† Can save you 2 months of loan processing hassle.
    </div>
    <h2 class="mb-4 text-center">Best Bank Loan Credit Engine</h2>
    <form id="loanForm">
      <h5 class="mb-3 mt-2">Applicant Details</h5>
      <div class="mb-3">
        <label class="form-label">Name</label>
        <input name="applicant_name" class="form-control" required />
      </div>
     
      <div class="mb-3">
        <label class="form-label">Age</label>
        <input name="applicant_age" type="number" class="form-control" required />
      </div>
      <div class="mb-3">
        <label class="form-label">CIBIL Score</label>
        <input name="applicant_cibil_score" type="number" class="form-control" required />
      </div>

      <div class="mb-3">
        <label class="form-label">Salary Type</label>
        <select name="applicant_salary_type" class="form-select" id="applicantSalaryType">
          <option value="">Select</option>
          <option value="salary">Salary</option>
          <option value="business">Business</option>
        </select>
      </div>
      <div class="mb-3" id="applicantITR3YearsDiv" style="display:none;">
        <label class="form-label">ITR filed for past 3 years?</label><br>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="applicant_itr_3years" id="applicantITR3Yes" value="true">
          <label class="form-check-label" for="applicantITR3Yes">Yes</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="applicant_itr_3years" id="applicantITR3No" value="false">
          <label class="form-check-label" for="applicantITR3No">No</label>
        </div>
      </div>
      <div class="mb-3" id="applicantIncomeModeDiv">
        <label class="form-label">Income Mode</label>
        <select name="applicant_income_mode" class="form-select" required>
          <option value="account">Account</option>
          <option value="cash">Cash</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Income Amount <span style="font-size:0.95em;color:#888;">(Monthly)</span></label>
        <div class="input-group">
          <span class="input-group-text" style="background:#e3f2fd;color:#1976d2;font-weight:600;">‚Çπ</span>
          <input name="applicant_income_amount" type="text" class="form-control" id="applicantIncomeAmountInput" required />
        </div>
        <div id="applicantIncomeAmountInWords" class="form-text mt-1" style="color:#1976d2;font-weight:500;"></div>
      </div>
      <div id="applicantBusinessFields" style="display:none;">
        <div class="mb-3">
          <label class="form-label">Years of Operation</label>
          <input name="applicant_business_years_of_operation" type="number" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">ITR Available</label>
          <select name="applicant_business_itr_available" class="form-select">
            <option value="">Select</option>
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">ITR Years</label>
          <input name="applicant_business_itr_years" type="number" class="form-control" />
        </div>
      </div>
      <div class="mb-3">
        <label class="form-label">Existing Loan EMI <span style="font-size:0.95em;color:#888;">(Monthly)</span></label>
        <input name="applicant_existing_loan_emi" type="number" class="form-control" />
      </div>
      
      <div class="mb-3">
        <label class="form-label">Do you have any loan repayment issue?</label><br>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="loan_repayment_issue" id="loanRepaymentIssueNo" value="no" checked>
          <label class="form-check-label" for="loanRepaymentIssueNo">No</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="loan_repayment_issue" id="loanRepaymentIssueYes" value="yes">
          <label class="form-check-label" for="loanRepaymentIssueYes">Yes</label>
        </div>
      </div>
      <h5 class="mb-3 mt-4">Loan Details</h5>
      <div class="mb-3">
        <label class="form-label">Loan Type</label>
        <select name="loan_type" class="form-select" required>
          <option value="">Select</option>
          <option value="home_loan">Home Loan</option>
          <option value="loan_against_property">Loan Against Property</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Property Value <span style="font-size:0.95em;color:#888;">(in Rupees)</span></label>
        <div class="input-group">
          <span class="input-group-text" style="background:#e3f2fd;color:#1976d2;font-weight:600;">‚Çπ</span>
          <input name="property_value" type="text" class="form-control" id="propertyValueInput" required />
        </div>
        <div id="propertyValueInWords" class="form-text mt-1" style="color:#1976d2;font-weight:500;"></div>
      </div>
      <div class="mb-3">
        <label class="form-label">Property Approval</label>
        <select name="property_approval" class="form-select" required>
          <option value="">Select</option>
          <option value="DTCP">DTCP</option>
          <option value="Plan Approval">Plan Approval</option>
          <option value="None">None</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Requested Loan Amount <span style="font-size:0.95em;color:#888;">(in Rupees)</span></label>
        <div class="input-group">
          <span class="input-group-text" style="background:#e3f2fd;color:#1976d2;font-weight:600;">‚Çπ</span>
          <input name="loan_amount_requested" type="text" class="form-control" id="loanAmountRequestedInput" required />
        </div>
        <div id="loanAmountInWords" class="form-text mt-1" style="color:#1976d2;font-weight:500;"></div>
      </div>
      <h5 class="mb-3 mt-4">Co-applicant Details</h5>
      <div class="form-check mb-3">
        <input name="coapplicant_exists" type="checkbox" class="form-check-input" id="coapplicantExistsCheck" />
        <label class="form-check-label" for="coapplicantExistsCheck">Co-applicant Exists</label>
      </div>
      <div id="coapplicantFields" style="display:none;">
        <div class="mb-3">
          <label class="form-label">Name</label>
          <input name="coapplicant_name" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">Age</label>
          <input name="coapplicant_age" type="number" class="form-control" />
        </div>
       <div class="mb-3">
          <label class="form-label">Salary Type</label>
          <select name="coapplicant_salary_type" class="form-select" id="coapplicantSalaryType">
            <option value="">Select</option>
            <option value="salary">Salary</option>
            <option value="business">Business</option>
          </select>
        </div>
        <div class="mb-3" id="coapplicantITR3YearsDiv" style="display:none;">
          <label class="form-label">ITR filed for past 3 years?</label><br>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="coapplicant_itr_3years" id="coapplicantITR3Yes" value="true">
            <label class="form-check-label" for="coapplicantITR3Yes">Yes</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="coapplicant_itr_3years" id="coapplicantITR3No" value="false">
            <label class="form-check-label" for="coapplicantITR3No">No</label>
          </div>
        </div>
        <div class="mb-3" id="coapplicantIncomeModeDiv">
          <label class="form-label">Income Mode</label>
          <select name="coapplicant_income_mode" class="form-select" required>
            <option value="account">Account</option>
            <option value="cash">Cash</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Income Amount Monthly</label>
          <input name="coapplicant_income_amount" type="number" class="form-control" />
        </div>
        
        <div class="mb-3">
          <label class="form-label">Existing EMI Amount</label>
          <input name="coapplicant_existing_emi" type="number" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">Missing/Late Payments</label>
          <select name="coapplicant_missing_or_late_payment" class="form-select">
            <option value="">Select</option>
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
        <div id="coapplicantBusinessFields" style="display:none;">
          <div class="mb-3">
            <label class="form-label">Years of Operation</label>
            <input name="coapplicant_business_years_of_operation" type="number" class="form-control" />
          </div>
          <div class="mb-3">
            <label class="form-label">ITR Available</label>
            <select name="coapplicant_business_itr_available" class="form-select">
              <option value="">Select</option>
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">ITR Years</label>
            <input name="coapplicant_business_itr_years" type="number" class="form-control" />
          </div>
        </div>
      </div>
       <div class="mb-3">
        <label class="form-label">Phone Number</label>
        <input name="phone_number" class="form-control" required />
      </div>
      <div class="mb-3 mt-4 p-3 bg-light border rounded">
        <strong style="color: #d32f2f; font-size: 1.1em; letter-spacing: 0.5px;">Disclaimer:</strong><br>
        <span style="display: inline-block; background: linear-gradient(90deg, #ffe0e0 0%, #fffbe7 100%); color: #333; font-size: 1em; padding: 8px 12px; border-radius: 8px; margin-top: 4px; font-family: 'Segoe UI', 'Arial', sans-serif; box-shadow: 0 1px 4px #0001;">
          LoanPal AI is not a bank or lender. We only show sample loan offers based on your inputs and publicly or partner-provided policy data.<br>
          We do not share your contact details.<br>
          This is a logic-based tool for information purposes only. Final offers may vary.
        </span>
        <div class="form-check mt-2">
          <input class="form-check-input" type="checkbox" id="disclaimerAgreeCheck">
          <label class="form-check-label" for="disclaimerAgreeCheck">
            I understand and agree
          </label>
        </div>
      </div>
      <button type="submit" class="btn btn-primary w-100" id="getRecommendationBtn" disabled>Get Recommendation</button>
    </form>
    <div id="result" class="result-box"></div>
  </div>
  <script>
    $(function() {
      $("input[name='existing_loan']").on('change', function() {
        if ($(this).is(':checked')) {
          $('#existingLoanAmountDiv').show();
          $("input[name='existing_loan_amount']").attr('required', true);
        } else {
          $('#existingLoanAmountDiv').hide();
          $("input[name='existing_loan_amount']").val('').removeAttr('required');
        }
      });
      $("input[name='has_coapplicant']").on('change', function() {
        if ($(this).is(':checked')) {
          $('#coapplicantFields').show();
          $("input[name='coapplicant_monthly_income']").attr('required', true);
        } else {
          $('#coapplicantFields').hide();
          $("input[name='coapplicant_monthly_income']").val('').removeAttr('required');
          $("input[name='coapplicant_existing_loan']").prop('checked', false);
          $('#coapplicantExistingLoanAmountDiv').hide();
          $("input[name='coapplicant_existing_loan_amount']").val('').removeAttr('required');
        }
      });
      $("input[name='coapplicant_existing_loan']").on('change', function() {
        if ($(this).is(':checked')) {
          $('#coapplicantExistingLoanAmountDiv').show();
          $("input[name='coapplicant_existing_loan_amount']").attr('required', true);
        } else {
          $('#coapplicantExistingLoanAmountDiv').hide();
          $("input[name='coapplicant_existing_loan_amount']").val('').removeAttr('required');
        }
      });
      // Fix: Show/hide co-applicant fields using the correct checkbox and on page load
      $('#coapplicantFields').hide();
      $('#coapplicantExistsCheck').on('change', function() {
        if ($(this).is(':checked')) {
          $('#coapplicantFields').slideDown();
          $("input[name='coapplicant_monthly_income']").attr('required', true);
        } else {
          $('#coapplicantFields').slideUp();
          $("input[name='coapplicant_monthly_income']").val('').removeAttr('required');
          $("input[name='coapplicant_existing_loan']").prop('checked', false);
          $('#coapplicantExistingLoanAmountDiv').hide();
          $("input[name='coapplicant_existing_loan_amount']").val('').removeAttr('required');
        }
      });
      // On page load, ensure correct state
      if ($('#coapplicantExistsCheck').is(':checked')) {
        $('#coapplicantFields').show();
      } else {
        $('#coapplicantFields').hide();
      }
      // Show/hide ITR for 3 years radio based on salary type
      $('#coapplicantSalaryType').on('change', function() {
        if ($(this).val() === 'business') {
          $('#coapplicantITR3YearsDiv').slideDown();
        } else {
          $('#coapplicantITR3YearsDiv').slideUp();
          $("input[name='coapplicant_itr_3years']").prop('checked', false);
        }
      });
      // On page load, ensure correct state
      if ($('#coapplicantSalaryType').val() === 'business') {
        $('#coapplicantITR3YearsDiv').show();
      } else {
        $('#coapplicantITR3YearsDiv').hide();
      }
      // Show/hide applicant ITR for 3 years radio based on salary type
      $('#applicantSalaryType').on('change', function() {
        if ($(this).val() === 'business') {
          $('#applicantITR3YearsDiv').slideDown();
          $('#applicantIncomeModeDiv').slideUp();
          $("select[name='applicant_income_mode']").val('account'); // Always set to 'account' when hidden
          $("select[name='applicant_income_mode']").removeAttr('required');
        } else {
          $('#applicantITR3YearsDiv').slideUp();
          $("input[name='applicant_itr_3years']").prop('checked', false);
          $('#applicantIncomeModeDiv').slideDown();
          $("select[name='applicant_income_mode']").attr('required', true);
        }
      });
      // On page load, ensure correct state
      if ($('#applicantSalaryType').val() === 'business') {
        $('#applicantITR3YearsDiv').show();
        $('#applicantIncomeModeDiv').hide();
        $("select[name='applicant_income_mode']").val('account'); // Always set to 'account' when hidden
        $("select[name='applicant_income_mode']").removeAttr('required');
      } else {
        $('#applicantITR3YearsDiv').hide();
        $('#applicantIncomeModeDiv').show();
        $("select[name='applicant_income_mode']").attr('required', true);
      }
      $('#loanForm').on('submit', function(e) {
        e.preventDefault();
        var form = $(this).serializeArray();
        var data = {
          applicant: {
            business_details: {},
            existing_loan: {}
          },
          loan_details: {},
          co_applicant: {
            business_details: {},
            existing_loan: {}
          }
        };
        form.forEach(function(item) {
          // Applicant fields
            if (item.name === 'loan_repayment_issue') {
              
              data.loan_repayment_issue = (item.value === 'yes') ? true : false;
            }
           
          if (item.name === 'phone_number' || item.name === 'applicant_phone_number') {
            data.applicant.phone_number = item.value ? item.value : null;
          } else if (item.name.startsWith('applicant_')) {
            if (item.name.includes('business_')) {
              var key = item.name.replace('applicant_business_', '');
              data.applicant.business_details[key] = item.value ? (item.value === 'true' ? true : item.value === 'false' ? false : item.value) : null;
            } else if (item.name.includes('existing_loan_amount')) {
              data.applicant.existing_loan.loan_amount = Number(item.value) || 0;
            } else if (item.name.includes('existing_loan_emi')) {
              data.applicant.existing_loan.monthly_emi = Number(item.value) || 0;
            } else if (item.name === 'applicant_salary_type') {
              data.applicant.income_mode = item.value;
              data.applicant.income_type = item.value; // Fix: set both fields
            } else if (item.name === 'applicant_itr_3years') {
              // Fix: Only set true/false if value is not empty
              if (item.value === 'true') data.applicant.itr_3years = true;
              else if (item.value === 'false') data.applicant.itr_3years = false;
            } else if (item.name === 'loan_repayment_issue') {
              data.loan_repayment_issue = (item.value === 'yes');
              console.log('loan_repayment_issue value:', item.value, '->', data.loan_repayment_issue);
            } else {
              var key = item.name.replace('applicant_', '');
              data.applicant[key] = item.value ? (item.value === 'true' ? true : item.value === 'false' ? false : item.value) : null;
            }
          }
          // Loan details
          else if (item.name.startsWith('loan_')) {
            var key = item.name.replace('loan_', '');
            data.loan_details[key] = item.value ? (item.value === 'true' ? true : item.value === 'false' ? false : item.value) : null;
          }
          else if (item.name === 'property_value' || item.name === 'property_approval') {
            data.loan_details[item.name] = item.value ? (item.value === 'true' ? true : item.value === 'false' ? false : item.value) : null;
          }
          // Co-applicant fields
          else if (item.name.startsWith('coapplicant_')) {
            if (item.name === 'coapplicant_exists') {
              data.co_applicant.exists = true;
            } else if (item.name === 'coapplicant_age') {
              data.co_applicant.age = Number(item.value) || null;
            } else if (item.name.includes('business_')) {
              var key = item.name.replace('coapplicant_business_', '');
              data.co_applicant.business_details[key] = item.value ? (item.value === 'true' ? true : item.value === 'false' ? false : item.value) : null;
            } else if (item.name.includes('existing_loan_amount')) {
              data.co_applicant.existing_loan.loan_amount = Number(item.value) || 0;
            } else if (item.name.includes('existing_loan_emi')) {
              data.co_applicant.existing_loan.monthly_emi = Number(item.value) || 0;
            } else if (item.name === 'coapplicant_salary_type') {
              data.co_applicant.income_mode = item.value;
              data.co_applicant.income_type = item.value; // Fix: set both fields for co-applicant
            } else if (item.name === 'coapplicant_itr_3years') {
              // Fix: Only set true/false if value is not empty
              if (item.value === 'true') data.co_applicant.itr_3years = true;
              else if (item.value === 'false') data.co_applicant.itr_3years = false;
            } else if (item.name === 'coapplicant_existing_emi') {
              data.co_applicant.existing_emi = Number(item.value) || 0;
            } else if (item.name === 'coapplicant_missing_or_late_payment') {
              data.co_applicant.missing_or_late_payment = item.value === 'true';
            } else {
              var key = item.name.replace('coapplicant_', '');
              data.co_applicant[key] = item.value ? (item.value === 'true' ? true : item.value === 'false' ? false : item.value) : null;
            }
          
          }
           
        });
        // Ensure loan_repayment_issue is always set (default to false if not present)
        if (typeof data.loan_repayment_issue === 'undefined') {
          data.loan_repayment_issue = false;
        }
      
        
        // Ensure requested loan amount is mapped correctl
        data.loan_details.loan_amount_requested = $("input[name='loan_amount_requested']").val() ? Number($("input[name='loan_amount_requested']").val()) : 0;
        //TypeError: unsupported operand type(s) for /: 'dict' and 'int'
        if (!data.co_applicant.exists) {
          data.co_applicant = {
            exists: false,
            business_details: {},
            existing_loan: {},
            income_mode: '', // Ensure always present
            income_type: ''  // Ensure always present
          };
        }
        // Remove commas before sending to backend for numeric fields
        if (data.applicant && data.applicant.income_amount) {
          data.applicant.income_amount = String(data.applicant.income_amount).replace(/,/g, '');
        }
        if (data.loan_details && data.loan_details.loan_amount_requested) {
          data.loan_details.loan_amount_requested = String(data.loan_details.loan_amount_requested).replace(/,/g, '');
        }
        // Remove commas and convert property_value to integer
        if (data.loan_details && data.loan_details.property_value) {
          data.loan_details.property_value = parseInt(String(data.loan_details.property_value).replace(/,/g, ''), 10) || 0;
        }
        // Also ensure loan_amount_requested is sent as integer
        if (data.loan_details && data.loan_details.loan_amount_requested) {
          data.loan_details.loan_amount_requested = parseInt(data.loan_details.loan_amount_requested, 10) || 0;
        }
     
     
        $('#result').html('<em>Loading...</em>');
        $.ajax({
          url: 'https://loanpalpoc-production.up.railway.app/full-eligibility',
          method: 'POST',
          contentType: 'application/json',
          data: JSON.stringify(data),
          success: function(res) {
            var form = data;
            var report = {
              name: form.applicant.name || '',
              phone_number: form.applicant.phone_number || '',
              type_of_loan: form.loan_details.type === 'home_loan' ? 'Home Loan' : 'Loan Against Property',
              address: '',
              loan_amount: form.applicant.existing_loan.loan_amount || '',
              date: new Date().toISOString().slice(0, 10),
              eligible_banks: (res.eligible_banks || []).map(function(b) {
                return {
                  bank: b.bank,
                  eligible: b.eligible,
                  remarks: b.remarks,
                  loan_amount: b.loan_amount,
                  emi: b.emi,
                  tenure: b.tenure,
                  roi: b.roi || '-',
                  amortization_schedule: b.amortization_schedule || []
                };
              }),
              enhancement_insights: [],
              total_emi: ''
            };
            localStorage.setItem('loan_report', JSON.stringify(report));
            window.location.href = 'loan_report.html';
          },
          error: function(xhr) {
            $('#result').html('<span style="color:red;">Error: ' + xhr.responseText + '</span>');
          }
        });
      });
      // Disclaimer checkbox logic
      $('#disclaimerAgreeCheck').on('change', function() {
        if ($(this).is(':checked')) {
          $('#getRecommendationBtn').prop('disabled', false);
        } else {
          $('#getRecommendationBtn').prop('disabled', true);
        }
      });
      // On page load, ensure button is disabled
      $('#getRecommendationBtn').prop('disabled', !$('#disclaimerAgreeCheck').is(':checked'));

      // Loan amount comma separation and in-words display
      function formatNumberWithCommas(x) {
        if (!x) return '';
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      }
      function numberToWords(num) {
        if (!num || isNaN(num)) return '';
        var a = ["", "Thousand", "Lakh", "Crore"];
        var n = parseInt(num, 10);
        if (n < 1000) return n + ' Rupees';
        if (n < 100000) return (n/1000).toFixed(2) + ' Thousand Rupees';
        if (n < 10000000) return (n/100000).toFixed(2) + ' Lakh Rupees';
        return (n/10000000).toFixed(2) + ' Crore Rupees';
      }
      $('#loanAmountRequestedInput').on('input', function() {
        var raw = $(this).val().replace(/,/g, '');
        if (!isNaN(raw) && raw !== '') {
          var formatted = formatNumberWithCommas(raw);
          $(this).val(formatted);
          $('#loanAmountInWords').text(numberToWords(raw));
        } else {
          $('#loanAmountInWords').text('');
        }
      });
      // On page load, show in-words if value exists
      var initialLoanAmt = $('#loanAmountRequestedInput').val().replace(/,/g, '');
      if (initialLoanAmt) {
        $('#loanAmountInWords').text(numberToWords(initialLoanAmt));
      }
      // Property value comma separation and in-words display

       $('#propertyValueInput').on('input', function() {
        var raw = $(this).val().replace(/,/g, '');
        if (!isNaN(raw) && raw !== '') {
          var formatted = formatNumberWithCommas(raw);
          $(this).val(formatted);
          $('#propertyValueInWords').text(numberToWords(raw));
        } else {
          $('#propertyValueInWords').text('');
        }
      });
      // On page load, show in-words if value exists
      var initialLoanAmt = $('#propertyValueInput').val().replace(/,/g, '');
      if (initialLoanAmt) {
        $('#propertyValueInWords').text(numberToWords(initialLoanAmt));
      }


      // Income amount comma separation and in-words display
      $('#applicantIncomeAmountInput').on('input', function() {
        var raw = $(this).val().replace(/,/g, '');
        if (!isNaN(raw) && raw !== '') {
          var formatted = formatNumberWithCommas(raw);
          $(this).val(formatted);
          $('#applicantIncomeAmountInWords').text(numberToWords(raw));
        } else {
          $('#applicantIncomeAmountInWords').text('');
        }
      });
      // On page load, show in-words if value exists
      var initialIncomeAmt = $('#applicantIncomeAmountInput').val().replace(/,/g, '');
      if (initialIncomeAmt) {
        $('#applicantIncomeAmountInWords').text(numberToWords(initialIncomeAmt));
      }
    });
  </script>
</body>
</html>
